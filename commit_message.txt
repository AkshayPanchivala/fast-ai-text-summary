feat: Complete TypeScript migration and update tests